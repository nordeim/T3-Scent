$ egrep '^```|^// ' design_document_4_refined.md 
```prisma
// prisma/schema.prisma
// Core Models
// Product Catalog Models
// Order Management Models
// Customer Interaction Models
// Subscription & Loyalty Models
// RBAC Models
// Inventory Forecasting Models
// Smart Home Models
// Operational Models
// Enums
```
```ts
// tailwind.config.ts
```
```js
// src/env.mjs
```
```typescript
// src/server/db.ts
```
```typescript
// src/server/auth.ts
// Define a more specific User type for NextAuth that includes roleId
// Helper to protect admin routes/API procedures
```
```typescript
// src/server/api/trpc.ts
// Middleware for admin-only procedures
// Middleware for role-based access control
// This is a more generic one, you might create specific ones like enforceUserIsManager
```
```typescript
// src/utils/api.ts
```
```typescript
// src/server/api/root.ts
// export type definition of API
```
```typescript
// src/server/api/routers/products.ts
```
```typescript
// src/server/api/routers/orders.ts
// Helper to get or create Stripe Customer ID and link it to our User
// Helper function to format currency (could be moved to a utils file)
```
```typescript
// src/server/api/routers/recommendations.ts
// Define a type for product with recommendation scores
```
```tsx
// src/contexts/CartContext.tsx
```
```prisma
// prisma/schema.prisma
// Core Models
// Product Catalog Models
// Order Management Models
// Customer Interaction Models
// Subscription & Loyalty Models
// RBAC Models
// Inventory Forecasting Models
// Smart Home Models
// Operational Models
// Enums
```
```ts
// tailwind.config.ts
```
```js
// src/env.mjs
```
```typescript
// src/server/db.ts
```
```typescript
// src/server/auth.ts
// Define a more specific User type for NextAuth that includes roleId
// HOC for protecting pages server-side
```
```typescript
// src/server/api/trpc.ts
```
```typescript
// src/utils/api.ts
// Custom link to handle errors globally
```
```typescript
// src/server/api/root.ts
// export type definition of API
```
```typescript
// src/server/api/routers/admin/products.ts
```
```tsx
// src/pages/products/[slug].tsx
// Define a more specific type for the product prop after GSSP processing
```
```tsx
// src/components/ui/Button.tsx
// Placeholder: Implementation for Button component expected here.
// This is typically provided by a UI library like Shadcn/ui or custom-built.
// Simplified props for placeholder
```
```ts
// src/utils/format.ts
```

